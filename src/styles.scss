@use '@angular/material' as mat;

// Custom palette maps
$brand-primary-map: (
  50: #e5f3fb,
  100: #c2e1f6,
  200: #9ccdf0,
  300: #75b6e7,
  400: #54a3df,
  500: #0077c8,
  600: #006ab4,
  700: #005fa3,
  800: #004a80,
  900: #003456,
  A100: #cfe8ff,
  A200: #9ad2ff,
  A400: #53b3ff,
  A700: #2e9eff,
  contrast: (
    50: #333333,
    100: #333333,
    200: #333333,
    300: #333333,
    400: #333333,
    500: #ffffff,
    600: #ffffff,
    700: #ffffff,
    800: #ffffff,
    900: #ffffff,
    A100: #333333,
    A200: #333333,
    A400: #ffffff,
    A700: #ffffff,
  ),
);

$brand-secondary-map: (
  50: #e0f8f4,
  100: #b3ede3,
  200: #80e1d1,
  300: #4dd4c0,
  400: #29c9b4,
  500: #00bfa5,
  600: #00a991,
  700: #008f79,
  800: #007661,
  900: #005545,
  contrast: (
    50: #333333,
    100: #333333,
    200: #333333,
    300: #333333,
    400: #333333,
    500: #ffffff,
    600: #ffffff,
    700: #ffffff,
    800: #ffffff,
    900: #ffffff,
  ),
);

$brand-warn-map: (
  50: #fef1e5,
  100: #fcdab8,
  200: #fbc28a,
  300: #f8a85c,
  400: #f7933a,
  500: #f4a261,
  600: #e9893f,
  700: #d97329,
  800: #c6601a,
  900: #a64508,
  contrast: (
    50: #333333,
    100: #333333,
    200: #333333,
    300: #333333,
    400: #333333,
    500: #ffffff,
    600: #ffffff,
    700: #ffffff,
    800: #ffffff,
    900: #ffffff,
  ),
);

$brand-primary: mat.m2-define-palette($brand-primary-map, 500, 100, 700);
$brand-accent: mat.m2-define-palette($brand-secondary-map, 500, 100, 700);
$brand-warn: mat.m2-define-palette($brand-warn-map, 500, 100, 700);

$brand-theme: mat.m2-define-light-theme((
  color: (
    primary: $brand-primary,
    accent: $brand-accent,
    warn: $brand-warn,
  ),
  density: 0,
));

@include mat.core();

// Global Mobile Optimizations
@media (max-width: 768px) {
  // Touch-friendly targets (minimum 44x44px)
  button,
  a,
  .mat-mdc-button,
  .mat-mdc-icon-button,
  .mat-mdc-fab,
  .mat-mdc-mini-fab {
    min-height: 44px !important;
    min-width: 44px !important;
  }

  // Form fields mobile optimization
  .mat-mdc-form-field {
    width: 100% !important;
    margin-bottom: 8px;
  }

  // Cards and containers
  .mat-mdc-card {
    margin-bottom: 16px;
  }

  // Typography adjustments
  h1 {
    font-size: 24px !important;
    line-height: 1.3 !important;
  }

  h2 {
    font-size: 20px !important;
    line-height: 1.3 !important;
  }

  h3 {
    font-size: 18px !important;
    line-height: 1.3 !important;
  }

  // Spacing adjustments
  .mat-mdc-dialog-container {
    max-width: 100vw !important;
    margin: 0 !important;
    border-radius: 0 !important;
  }

  .mat-mdc-dialog-content {
    max-height: calc(100vh - 200px) !important;
    padding: 16px !important;
  }

  // Table responsive wrapper
  .table-responsive {
    display: block;
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;

    table {
      min-width: 600px;
    }
  }

  // Flexbox mobile adjustments
  .mobile-stack {
    flex-direction: column !important;

    > * {
      width: 100% !important;
      margin-bottom: 12px;
    }
  }

  // Hide non-essential elements on mobile
  .mobile-hide {
    display: none !important;
  }

  // Mobile table card view helper
  .mobile-table-card {
    display: none;
  }
}

// Small mobile devices
@media (max-width: 480px) {
  // Smaller touch targets for very small screens
  button,
  a,
  .mat-mdc-button,
  .mat-mdc-icon-button {
    min-height: 40px !important;
    min-width: 40px !important;
  }

  // Even more compact spacing
  .mat-mdc-card {
    margin-bottom: 12px;
  }

  h1 {
    font-size: 20px !important;
  }

  h2 {
    font-size: 18px !important;
  }

  h3 {
    font-size: 16px !important;
  }
}

@media (max-width: 480px) {
  h1 {
    font-size: 20px !important;
  }

  h2 {
    font-size: 18px !important;
  }

  h3 {
    font-size: 16px !important;
  }
}
@include mat.all-component-themes($brand-theme);

html,
body {
  height: 100%;
  background-color: #f9fafb;
  color: #333333;
}

body {
  margin: 0;
  font-family: Inter, "Helvetica Neue", Helvetica, Roboto, Arial, saudi_riyal, sans-serif;
  font-weight: 400;
  line-height: 1.5;
}

a {
  color: #0077c8;
  text-decoration: none;
  transition: color 120ms ease-in-out;

  &:hover {
    color: #005fa3;
  }
}

button.mat-mdc-button,
button.mat-mdc-raised-button,
button.mat-mdc-stroked-button,
button.mat-mdc-unelevated-button,
button.mat-mdc-outlined-button {
  border-radius: 6px !important;
  font-weight: 500 !important;
  padding: 8px 16px !important;
  font-size: 0.800rem !important;
  text-transform: none !important;
}

.mat-mdc-raised-button.mat-primary,
.mat-mdc-unelevated-button.mat-primary {
  background: #0077c8 !important;
  color: #ffffff !important;

  &:hover {
    background: #005fa3 !important;
  }
}

.mat-mdc-stroked-button.mat-primary {
  border-color: #0077c8 !important;
  color: #0077c8 !important;

  &:hover {
    background: rgba(0, 119, 200, 0.08) !important;
  }
}

.mat-mdc-card {
  border-radius: 10px !important;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08) !important;
  background-color: #ffffff;
  border: 1px solid #e0e0e0;
}

// Global table styles - streamlined
.mat-mdc-table {
  background: #ffffff !important;
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #e0e0e0;
  font-size: 0.8rem !important;
  
  th {
    padding: 8px 10px !important;
    font-size: 0.75rem !important;
    font-weight: 600 !important;
    line-height: 1.4 !important;
  }
  
  td {
    padding: 8px 10px !important;
    font-size: 0.8rem !important;
    line-height: 1.4 !important;
  }
  
  .mat-mdc-header-row {
    min-height: 40px !important;
  }
  
  .mat-mdc-row {
    min-height: 40px !important;
  }
}

// Additional table styling for custom tables
table {
  th {
    padding: 8px 10px !important;
    font-size: 0.75rem !important;
    font-weight: 600 !important;
    line-height: 1.4 !important;
  }
  
  td {
    padding: 8px 10px !important;
    font-size: 0.8rem !important;
    line-height: 1.4 !important;
  }
}

.mat-form-field-appearance-outline .mat-mdc-form-field-outline {
  border-radius: 6px;
}

// Reduced form field sizes globally
.mat-mdc-form-field {
  font-size: 0.800rem !important;

  .mat-mdc-text-field-wrapper {
    border-radius: 6px !important;
    border: 1px solid #e0e0e0 !important;
    padding-bottom: 0 !important;

    &.mdc-text-field--focused {
      border-color: #0077c8 !important;
      box-shadow: 0 0 0 2px rgba(0, 119, 200, 0.2) !important;
    }
  }

  .mat-mdc-form-field-infix {
    padding-top: 12px !important;
    // padding-bottom: 4px !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
    min-height: 40px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
  }

  .mat-mdc-form-field-label {
    font-size: 0.8rem !important;
  }

  input.mat-mdc-input-element,
  .mdc-text-field__input,
  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="password"],
  input[type="date"],
  input[type="time"] {
    font-size: 0.800rem !important;
    line-height: 1.5 !important;
    padding: 0 !important;
    padding-left: 0 !important;
    margin: 0 !important;
    margin-top: 0 !important;
    padding-top: 0 !important;
    height: 20px !important;
    box-sizing: border-box !important;
    border: none !important;
    outline: none !important;
    background: transparent !important;
    display: block !important;
    width: 100% !important;
    vertical-align: top !important;
  }

  textarea.mat-mdc-input-element,
  textarea {
    font-size: 0.800rem !important;
    line-height: 1.5 !important;
    padding: 0 !important;
    margin: 0 !important;
    vertical-align: middle !important;
    resize: vertical !important;
  }

  .mat-mdc-select {
    font-size: 0.800rem !important;
    line-height: 1.5 !important;
  }

  .mat-mdc-select-trigger {
    font-size: 0.800rem !important;
    padding: 0 !important;
    padding-left: 0 !important;
    line-height: 1.5 !important;
    height: 20px !important;
    margin-top: 0 !important;
    display: flex !important;
    align-items: center !important;
  }

  .mat-mdc-select-value {
    line-height: 1.5 !important;
    display: inline-block !important;
  }

  .mat-mdc-select-value-text {
    line-height: 1.5 !important;
    display: inline-block !important;
  }

  .mat-mdc-form-field-subscript-wrapper {
    color: #666666;
    font-size: 0.75rem !important;
    margin-top: 2px !important;
  }

  .mat-mdc-form-field-hint {
    font-size: 0.75rem !important;
  }

  // Date picker toggle - properly aligned with reduced field height
  .mat-datepicker-toggle {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-left: 4px !important;
    height: 100% !important;

    .mat-icon-button {
      width: 28px !important;
      height: 28px !important;
      padding: 0 !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      flex-shrink: 0 !important;
      line-height: 1 !important;

      .mat-icon {
        font-size: 16px !important;
        width: 16px !important;
        height: 16px !important;
        line-height: 1 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
      }
    }
  }

  // Label wrapper alignment - ensure labels are not cut off
  .mat-mdc-form-field-label-wrapper {
    padding-top: 0 !important;
    overflow: visible !important;
    height: auto !important;
    min-height: 20px !important;
    top: 0 !important;
  }
  
  // Ensure the text field wrapper doesn't clip labels
  .mat-mdc-text-field-wrapper {
    overflow: visible !important;
  }
  
  // Ensure the form field container doesn't clip
  .mat-mdc-form-field {
    overflow: visible !important;
  }

  // Floating label alignment - center when not floating
  .mdc-floating-label {
    line-height: 1.5 !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    transform-origin: left center !important;
    
    &.mdc-floating-label--float-above {
      top: -6px !important;
      transform: scale(0.75) translateY(-50%) !important;
    }
  }
  
  // Ensure label is visible when floating
  &.mat-form-field-should-float,
  &.mat-focused {
    .mdc-floating-label {
      top: -6px !important;
      transform: scale(0.75) translateY(-50%) !important;
    }
    
    // Hide placeholder when label is floating
    .mdc-text-field__input::placeholder {
      opacity: 0 !important;
    }
  }
  
  // Hide placeholder when label is present and field is not focused
  &:not(.mat-focused):not(.mat-form-field-should-float) {
    .mdc-text-field__input::placeholder {
      opacity: 0 !important;
    }
  }

  // Input container alignment - ensure proper vertical centering
  .mdc-text-field__input {
    line-height: 1.5 !important;
    height: 20px !important;
    margin-top: 0 !important;
    padding-top: 0 !important;
    vertical-align: middle !important;
    
    &::placeholder {
      line-height: 1.5 !important;
      opacity: 0.6 !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
    }
  }

  // Icon prefix - CRITICAL FIX: Proper spacing to prevent collision
  .mat-mdc-form-field-icon-prefix {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-right: 16px !important;
    margin-left: 12px !important;
    width: 24px !important;
    min-width: 24px !important;
    flex-shrink: 0 !important;
    padding: 0 !important;

    mat-icon {
      font-size: 24px !important;
      width: 24px !important;
      height: 24px !important;
    }
  }

  // Icon container - ensure proper width allocation
  .mat-mdc-form-field-icon-container {
    min-width: 56px !important;
    padding: 0 4px !important;
  }

  // CRITICAL FIX: Move placeholder and text to the right when prefix icon exists
  // Material adds class 'mdc-text-field--with-leading-icon' when prefix icon exists
  .mdc-text-field--with-leading-icon {
    .mdc-text-field__input,
    input.mdc-text-field__input,
    textarea.mdc-text-field__input {
      padding-left: 20px !important;
    }

    .mat-mdc-select-trigger {
      padding-left: 20px !important;
    }
  }
  
  // ULTRA SPECIFIC: Target any input that follows a prefix icon
  .mat-mdc-form-field-icon-prefix + .mat-mdc-text-field-input-control .mdc-text-field__input,
  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control .mdc-text-field__input,
  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control input,
  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control textarea {
    padding-left: 20px !important;
  }
  
  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control .mat-mdc-select-trigger {
    padding-left: 20px !important;
  }

  // Alternative: Target by form field structure - when icon prefix exists anywhere in form field
  .mat-mdc-form-field {
    // When form field contains prefix icon
    &:has(.mat-mdc-form-field-icon-prefix) {
      .mdc-text-field__input {
        padding-left: 12px !important;
        padding-right: 0 !important;
        padding-top: 0 !important;
        padding-bottom: 0 !important;
      }

      .mat-mdc-select-trigger {
        padding-left: 12px !important;
        padding-right: 0 !important;
        padding-top: 0 !important;
        padding-bottom: 0 !important;
      }

      input.mdc-text-field__input,
      textarea.mdc-text-field__input {
        padding-left: 12px !important;
        padding-right: 0 !important;
        padding-top: 0 !important;
        padding-bottom: 0 !important;
      }
    }

    // Also target the input control area directly
    .mat-mdc-text-field-input-control {
      // When preceded by icon prefix in same form field
      .mdc-text-field__input {
        // This will be overridden by more specific selectors above
      }
    }
  }

  // ADDITIONAL FIX: Override the global padding: 0 rule more specifically
  // This must come after the global rule to override it
  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control .mdc-text-field__input,
  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control input,
  .mdc-text-field--with-leading-icon .mat-mdc-text-field-input-control .mdc-text-field__input,
  .mdc-text-field--with-leading-icon .mat-mdc-text-field-input-control input {
    padding-left: 12px !important;
  }

  .mat-mdc-form-field-icon-prefix ~ .mat-mdc-text-field-input-control .mat-mdc-select-trigger,
  .mdc-text-field--with-leading-icon .mat-mdc-text-field-input-control .mat-mdc-select-trigger {
    padding-left: 12px !important;
  }

  .mat-mdc-form-field-icon-suffix {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-left: 4px !important;
    // width: 24px !important;
    min-width: 24px !important;
    flex-shrink: 0 !important;
  }

  // Select arrow
  .mat-mdc-select-arrow {
    width: 16px !important;
    height: 16px !important;
  }
}

.mat-mdc-form-field-subscript-wrapper {
  color: #666666;
  font-size: 0.75rem !important;
}

.mat-icon {
  vertical-align: middle;
  font-size: 18px;
  line-height: 1;
  color: #666666;
}

// Date picker calendar
.mat-datepicker-content {
  .mat-calendar {
    font-size: 0.800rem !important;
  }

  .mat-calendar-body-cell-content {
    font-size: 0.800rem !important;
    width: 32px !important;
    height: 32px !important;
    line-height: 32px !important;
  }

  .mat-calendar-table-header th {
    font-size: 0.75rem !important;
    padding: 8px 0 !important;
  }
}

// Select dropdown
// Fix z-index for mat-select panels inside dialogs
.mat-mdc-dialog-container {
  .mat-mdc-select-panel {
    z-index: 10000 !important;
  }
  
  // Allow overflow for dropdowns
  overflow: visible !important;
}

// Ensure CDK overlay for select panels in dialogs has proper z-index
.cdk-overlay-container {
  z-index: 1000 !important;
  
  .cdk-overlay-pane.mat-mdc-select-panel {
    z-index: 10000 !important;
    position: fixed !important;
  }
}

// Mobile-specific fixes for select panels in dialogs
@media (max-width: 768px) {
  .cdk-overlay-container {
    z-index: 1000 !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
  }

  .cdk-overlay-pane {
    &.mat-mdc-select-panel {
      z-index: 10001 !important;
      position: fixed !important;
      max-width: 90vw !important;
      max-height: 70vh !important;
      touch-action: manipulation !important;
      -webkit-tap-highlight-color: transparent !important;
      -webkit-overflow-scrolling: touch !important;
    }
  }

  .mat-mdc-dialog-container {
    overflow: visible !important;
    max-height: 90vh !important;
    
    .mat-mdc-select-panel {
      z-index: 10001 !important;
    }
  }

  // Ensure select trigger is touch-friendly
  .mat-mdc-select-trigger {
    touch-action: manipulation !important;
    -webkit-tap-highlight-color: transparent !important;
  }
}

.mat-mdc-select-panel {
  .mat-mdc-option {
    font-size: 0.800rem !important;
    min-height: 36px !important;
    padding: 8px 16px !important;
  }
}

// Textarea
textarea.mat-mdc-input-element {
  font-size: 0.800rem !important;
  line-height: 1.5 !important;
  padding: 6px 0 !important;
  margin: 0 !important;
  vertical-align: middle !important;
  resize: vertical !important;
}

// Additional Material Design alignment fixes
.mat-mdc-form-field {
  // Ensure input text is vertically centered
  .mdc-text-field__input {
    line-height: 1.5 !important;
    height: 20px !important;
    
    &::placeholder {
      line-height: 1.5 !important;
      opacity: 0.6 !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
    }
  }

  // Fix select value alignment
  .mat-mdc-select-value-text {
    line-height: 1.5 !important;
    display: inline-block !important;
  }
  
  // Ensure text field wrapper has proper height
  .mat-mdc-text-field-wrapper {
    max-height: 40px !important;
  }
}

// Global placeholder alignment
input::placeholder,
textarea::placeholder,
.mdc-text-field__input::placeholder {
  line-height: 1.5 !important;
  opacity: 0.6 !important;
  text-decoration: none !important;
  text-decoration-line: none !important;
}

// CRITICAL: Remove strikethrough from all form field labels and placeholders
.mat-mdc-form-field-label,
.mdc-floating-label,
mat-label,
.mat-mdc-select-value-text,
.mdc-text-field__input,
input::placeholder,
textarea::placeholder {
  text-decoration: none !important;
  text-decoration-line: none !important;
  text-decoration-style: none !important;
  text-decoration-color: transparent !important;
}

button mat-icon,
button .mat-icon {
  margin-right: 6px;
}

// Make icons white in primary buttons
.mat-mdc-raised-button.mat-primary mat-icon,
.mat-mdc-unelevated-button.mat-primary mat-icon,
.mat-mdc-flat-button.mat-primary mat-icon,
button[mat-raised-button][color="primary"] mat-icon,
button[mat-flat-button][color="primary"] mat-icon,
button[mat-unelevated-button][color="primary"] mat-icon {
  color: #ffffff !important;
}

.app-shell {
  min-height: 100vh;
  background: #f9fafb;
}

.page-heading {
  font-size: 1.5rem;
  font-weight: 600;
  margin: 0;
  color: #333333;
}

.section-subtitle {
  font-size: 0.800rem;
  color: #666666;
  margin: 4px 0 0;
}

.snack-error {
  background-color: #e53935;
  color: #ffffff;
}

.snack-success {
  background-color: #00a86b;
  color: #ffffff;
}

.card-surface {
  border-radius: 12px;
  background: #ffffff;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  border: 1px solid #e0e0e0;
}

// Global mobile responsive styles
@media (max-width: 768px) {
  // Make all buttons touch-friendly
  button.mat-mdc-button,
  button.mat-mdc-raised-button,
  button.mat-mdc-stroked-button {
    min-height: 44px;
    min-width: 44px;
    padding: 10px 16px !important;
  }

  // Improve form field touch targets
  mat-form-field {
    .mat-mdc-form-field-subscript-wrapper {
      font-size: 0.75rem !important;
    }

    .mat-mdc-form-field-infix {
      min-height: 40px !important;
    }
  }

  // Make dialogs full-width on mobile
  .mat-mdc-dialog-container {
    .mdc-dialog__surface {
      max-width: 100vw !important;
      margin: 0;
      border-radius: 0;
    }
  }

  // Improve table scrolling on mobile
  .mat-mdc-table {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  // Touch-friendly chips
  mat-chip {
    min-height: 32px;
    padding: 4px 12px;
  }

  // Reduce padding on mobile
  .mat-mdc-card {
    padding: 16px !important;
  }
}

// Global print styles - Minimal, let components handle their own print styles
@media print {
  // Only hide navigation elements globally
  mat-sidenav,
  .side-nav,
  .top-bar,
  mat-toolbar,
  .spacer,
  .user-chip,
  .menu-button {
    display: none !important;
  }

  // Clean body for printing
  body {
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    overflow: visible !important;
  }

  // Don't hide containers - let content flow
  app-shell,
  mat-sidenav-container,
  mat-sidenav-content,
  .content-area {
    position: static !important;
    overflow: visible !important;
    height: auto !important;
  }
}

.mat-mdc-form-field-hint-wrapper, .mat-mdc-form-field-error-wrapper {
  position: relative !important;
  padding: 0px !important;
}